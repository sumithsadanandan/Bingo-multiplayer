<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sumithâ€™s Bingo - 2 Player</title>
<style>
body{margin:0;font-family:sans-serif;display:flex;flex-direction:column;align-items:center;padding:16px;background:#fde2e4;}
h1{margin:6px 0;}
.board-container{display:flex;gap:16px;margin-top:16px;flex-wrap:wrap;}
.player-board{background:#fff;padding:12px;border-radius:16px;box-shadow:0 8px 20px rgba(0,0,0,0.08);text-align:center;}
.grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-top:8px;}
.cell{aspect-ratio:1;display:flex;justify-content:center;align-items:center;border-radius:12px;border:2px solid #e8e8e8;font-weight:600;cursor:pointer;transition:0.25s;}
.cell.marked{background:#e6dbff;}
.cell.completed{background:#c8f7dc;}
button{margin-top:16px;padding:12px 24px;border:none;border-radius:30px;background:#f48fb1;color:#fff;cursor:pointer;font-size:16px;}
#turnIndicator{margin-top:12px;font-weight:600;font-size:18px;}
canvas{position:fixed;inset:0;pointer-events:none;}
#winner{margin-top:8px;font-weight:600;}
#calledNumbers{margin-top:12px;font-weight:500;}
</style>
</head>
<body>

<h1>Sumithâ€™s Bingo</h1>
<div id="turnIndicator">Loading game...</div>
<div id="calledNumbers"></div>
<button id="callNumberBtn">Call Number</button>

<div class="board-container">
  <div class="player-board">
    <h2>Your Board</h2>
    <div class="grid" id="grid"></div>
    <div id="winner"></div>
  </div>
</div>

<audio id="sound" src="sound-effect-bingo-122339.mp3"></audio>
<canvas id="confetti"></canvas>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ðŸ”¹ Replace with your Firebase config
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const gameRef = db.ref('game');

const SIZE=5;
let boardNums=[], cells=[], calledNumbers=[], playerId=prompt("Enter 1 or 2 as your player ID"), bingo=false;
const grid=document.getElementById('grid');
const turnIndicator=document.getElementById('turnIndicator');
const calledNumbersDiv=document.getElementById('calledNumbers');
const sound=document.getElementById('sound');

// Generate local board
function generateBoard(){
  grid.innerHTML='';
  cells.length=0;
  const nums=[...Array(25).keys()].map(i=>i+1).sort(()=>Math.random()-0.5);
  boardNums=nums;
  nums.forEach(n=>{
    const cell=document.createElement('div');
    cell.className='cell';
    cell.textContent=n;
    cells.push(cell);
    grid.appendChild(cell);
  });
  // Save to Firebase under player's board
  const boardKey = playerId==='1'?'board1':'board2';
  gameRef.child(boardKey).set(nums);
}

// Listen to Firebase updates
gameRef.on('value',snapshot=>{
  const data=snapshot.val();
  if(!data) return;
  calledNumbers=data.calledNumbers||[];
  document.getElementById('calledNumbers').textContent="Called Numbers: "+calledNumbers.join(', ');
  // Mark cells
  cells.forEach((cell,i)=>{
    if(calledNumbers.includes(+cell.textContent)) cell.classList.add('marked');
  });
  // Check bingo
  checkBingo();
  // Turn
  if(data.currentPlayer) turnIndicator.textContent="Current Turn: Player "+data.currentPlayer;
  // Disable call button if not your turn
  document.getElementById('callNumberBtn').disabled=(data.currentPlayer!=playerId);
});

// Call number
document.getElementById('callNumberBtn').onclick=function(){
  gameRef.once('value').then(snapshot=>{
    const data=snapshot.val();
    let remaining=[...Array(25).keys()].map(i=>i+1).filter(n=>!data.calledNumbers.includes(n));
    if(!remaining.length) return;
    const num=remaining[Math.floor(Math.random()*remaining.length)];
    const newCalled=[...data.calledNumbers,num];
    const nextPlayer=(playerId==='1')?2:1;
    gameRef.update({calledNumbers:newCalled, currentPlayer:nextPlayer});
  });
};

// Bingo check
function checkBingo(){
  if(bingo) return;
  const lines=[];
  for(let r=0;r<SIZE;r++) lines.push([...Array(SIZE)].map((_,c)=>r*SIZE+c));
  for(let c=0;c<SIZE;c++) lines.push([...Array(SIZE)].map((_,r)=>r*SIZE+c));
  let won=false;
  lines.forEach(line=>{
    if(line.every(i=>calledNumbers.includes(boardNums[i]))) won=true;
  });
  if(won){
    bingo=true;
    document.getElementById('winner').textContent="ðŸŽ‰ BINGO!";
    sound.currentTime=0; sound.play();
    confetti();
  }
}

/* CONFETTI */
function confetti(){
  const c=document.getElementById('confetti'); const ctx=c.getContext('2d');
  c.width=innerWidth; c.height=innerHeight;
  const pieces=[...Array(120)].map(()=>({x:Math.random()*c.width,y:-20,r:Math.random()*6+4,v:Math.random()*3+2,col:['#f48fb1','#ce93d8','#b39ddb','#80cbc4','#a5d6a7'][Math.floor(Math.random()*5)]}));
  let frame=0;
  function draw(){ctx.clearRect(0,0,c.width,c.height);pieces.forEach(p=>{p.y+=p.v;ctx.fillStyle=p.col;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();});if(frame++<180)requestAnimationFrame(draw);}draw();
}

// Initialize
generateBoard();
</script>
</body>
</html>
